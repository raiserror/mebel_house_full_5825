{% extends "base.html" %}
{% load static %}
{% block title %}Регистрация{% endblock title %}

{% block style_css %}
<link rel="stylesheet" href="{% static 'deps/css/users/registration.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
{% endblock style_css %}

{% block content %}
<!-- Main Content -->
<main class="py-4">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="registration-card">
                    <div class="registration-header">
                        <h2>Создайте новый аккаунт</h2>
                        <p>Заполните форму ниже для регистрации</p>
                    </div>
                    
                    <div class="registration-body">
                        <form method="post" action="{% url 'users:registration' %}" method='post'>
                            {% csrf_token %}
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="id_first_name" class="form-label">Имя*</label>
                                    <input type="text" class="form-control" id="id_first_name"
                                           value="{% if form.first_name.value %}{{ form.first_name.value }}{% endif %}"
                                           name="first_name" placeholder="Введите ваше имя" required>
                                    {% if form.first_name.errors %}
                                    <div class="alert-simple error show">
                                        <div>
                                            {% for error in form.first_name.errors %}
                                            <div>{{ error }}</div>
                                            {% endfor %}
                                        </div>
                                        <button type="button" class="close-btn" aria-label="Закрыть">&times;</button>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="id_last_name" class="form-label">Фамилия*</label>
                                    <input type="text" class="form-control" id="id_last_name" 
                                           value="{% if form.last_name.value %}{{ form.last_name.value }}{% endif %}"
                                           name="last_name" placeholder="Введите вашу фамилию" required>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="id_username" class="form-label">Имя пользователя*</label>
                                    <input type="text" class="form-control" id="id_username" 
                                           value="{% if form.username.value %}{{ form.username.value }}{% endif %}"
                                           name="username" placeholder="Придумайте имя пользователя" required>
                                    {% if form.username.errors %}
                                    <div class="alert-simple error show">
                                        {% for error in form.username.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        <button type="button" class="close-btn" aria-label="Закрыть">&times;</button>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="id_email" class="form-label">Email*</label>
                                    <input type="email" class="form-control" id="id_email" 
                                           value="{% if form.email.value %}{{ form.email.value }}{% endif %}"
                                           name="email" placeholder="Введите ваш email" required>
                                    {% if form.email.errors %}
                                    <div class="alert-simple error show">
                                        <div>
                                            {% for error in form.email.errors %}
                                            <div>{{ error }}</div>
                                            {% endfor %}
                                        </div>
                                        <button type="button" class="close-btn" aria-label="Закрыть">&times;</button>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="id_password1" class="form-label">Пароль*</label>
                                    <input type="password" class="form-control" id="id_password1"
                                           value="{% if form.password1.value %}{{ form.password1.value }}{% endif %}" 
                                           name="password1" placeholder="Создайте пароль" required>
                                    <div class="password-info">
                                        <i class="bi bi-info-circle"></i> Пароль должен содержать не менее 8 символов
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="id_password2" class="form-label">Подтверждение пароля*</label>
                                    <input type="password" class="form-control" id="id_password2" 
                                           value="{% if form.password2.value %}{{ form.password2.value }}{% endif %}"
                                           name="password2" placeholder="Повторите пароль" required>
                                    {% if form.password2.errors %}
                                    <div class="alert-simple error show">
                                        {% for error in form.password2.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        <button type="button" class="close-btn" aria-label="Закрыть">&times;</button>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-register mt-3">
                                Зарегистрироваться
                            </button>
                            
                            <div class="login-link">
                                Уже есть аккаунт? <a href="{% url 'users:login' %}">Войдите</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock content %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Плавное появление формы
    document.addEventListener('DOMContentLoaded', function() {
        const formElements = document.querySelectorAll('.form-control, .btn-register');
        formElements.forEach((element, index) => {
            element.style.opacity = '0';
            element.style.transform = 'translateY(20px)';
            element.style.transition = `all 0.3s ease ${index * 0.1}s`;
            setTimeout(() => {
                element.style.opacity = '1';
                element.style.transform = 'translateY(0)';
            }, 100);
        });
    });
    
    // Валидация пароля
    document.getElementById('id_password1').addEventListener('input', function() {
        const password = this.value;
        const infoText = this.nextElementSibling;
        
        if (password.length > 0 && password.length < 8) {
            infoText.style.color = '#e74c3c';
        } else if (password.length >= 8) {
            infoText.style.color = '#2ecc71';
        } else {
            infoText.style.color = '#7f8c8d';
        }
    });
    document.querySelectorAll('.close-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.target.closest('.alert-simple').style.opacity = '0';
            setTimeout(() => {
                e.target.closest('.alert-simple').remove();
            }, 200);
        });
    });
</script>
{% endblock scripts %}